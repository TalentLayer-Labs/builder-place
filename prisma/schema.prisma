generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model BuilderPlace {
  id                       Int          @id @default(autoincrement())
  status                   EntityStatus @default(PENDING)
  name                     String
  subdomain                String?      @unique
  customDomain             String?      @unique
  talentLayerPlatformId    String?      @unique
  talentLayerPlatformName  String?      @unique
  owner                    User?        @relation(fields: [ownerId], references: [id])
  ownerId                  Int?         @unique
  collaborators            User[]       @relation("BuilderPlaceCollaborators")
  baseline                 String?
  about                    String?
  aboutTech                String?
  presentation             String?
  logo                     String?
  icon                     String?
  cover                    String?
  palette                  Json
  jobPostingConditions     Json?
  preferredWorkTypes       WorkType[]
}

model User {
  id                       Int            @id @default(autoincrement())
  status                   EntityStatus   @default(PENDING)
  name                     String
  email                    String         @unique
  address                  String         @unique
  talentLayerId            String?        @unique
  talentLayerHandle        String?        @unique
  isEmailVerified          Boolean        @default(false)
  about                    String?
  picture                  String?
  counterStartDate         Int            @default(0)
  weeklyTransactionCounter Int            @default(0)
  workerProfile            WorkerProfile? @relation("WorkerProfile")
  hirerProfile             HirerProfile?  @relation("HirerProfile")
  ownedBuilderPlace        BuilderPlace?
  managedPlaces            BuilderPlace[] @relation("BuilderPlaceCollaborators")
}

model WorkerProfile {
  id     Int      @id
  user   User     @relation("WorkerProfile", fields: [id], references: [id])
  skills String[]
}

model HirerProfile {
  id   Int  @id
  user User @relation("HirerProfile", fields: [id], references: [id])
}

enum EntityStatus {
  PENDING
  VALIDATED
}

enum WorkType {
  BOUNTIES
  GRANTS
  GIGS
  JOBS
}
